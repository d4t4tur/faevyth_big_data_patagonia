---
title: "DNMyE - SINTA"
author:  "Dirección Nacional de Mercados y Estadística"
output:
  xaringan::moon_reader:
    seal: false
    css: "dnmye_theme.css"
    nature:
      slideNumberFormat: "%current%"
      highlightStyle: github
      highlightLines: true
      ratio: 16:9
      countIncrementalSlides: true
---

class:inverse, middle

background-image: url(https://tableros.yvera.tur.ar/recursos/logos_institucionales/escudo_mdtyd_blanco.png)
background-position: 95% 95%
background-size: 30%

# Big data para el Turismo

### #LaRutaNatural PATAGONIA

<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>

### Dirección Nacional de Mercados y Estadística<br>Subsecretaría de Desarrollo Estratégico




```{r, echo=FALSE, warning=FALSE}
library(xaringanExtra)
# LOGO COLOR EN PAGs INTERNAS
xaringanExtra::use_logo(image_url = "https://tableros.yvera.tur.ar/recursos/logos_institucionales/escudo_mdtyd_color.png", 
                        position = css_position(top = "1em", right = "1em"), 
                        height = "20%", width = "20%")
# BARRA DE PROGRESO DE PRESENTACION
xaringanExtra::use_progress_bar(color = comunicacion::dnmye_colores("cian"))
# LAPIZ 
xaringanExtra::use_scribble()
# EXPLORADOR DE SLIDES
xaringanExtra::use_tile_view()
# HABILITAR WEBCAM
xaringanExtra::use_webcam()
```


```{r dnmye_theme, include=FALSE, warning=FALSE, eval=TRUE}
library(xaringanthemer) #EVAL FALSE
library(comunicacion)
style_mono_light(outfile = "dnmye_theme.css", # CSS FILE
                 # FONTS
                  header_font_google = google_font('Encode Sans'),
                  text_font_google   = google_font('Roboto'),
                  code_font_google   = google_font('IBM Plex Mono'),
                 # COLORES 
                 base_color = dnmye_colores("cian"),
                 code_inline_color = dnmye_colores("rosa"), 
                 inverse_link_color = "#3B4449",
                 background_color = "#FFFFFF",
                 title_slide_background_image = "escudo_mintur_blanco.png", 
                 title_slide_background_position = "95% 5%", 
                 title_slide_background_size = "200px", footnote_color = "#3B4449", link_color = "3B4449",text_slide_number_font_size = "16px"
                  
                 )
```


```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  # fig.width=9, fig.height=3.5, fig.retina=3,
  out.width = "100%", 
  cache = FALSE,
  echo = F,
  message = FALSE, 
  warning = FALSE,
  fig.show = TRUE,
  hiline = TRUE
)
```


```{css, echo=FALSE}
div.my-footer {
    background-color: white;
    position: absolute;
    bottom: 0px;
    left: 0px;
    height: 40px;
    width: 100%;
}
div.my-footer span {
    font-size: 16px;
    color: #3B4449;
    position: absolute;
    left: 15px;
    bottom: 6px;
}


```


---

layout: true

<div class="my-footer"><span>DIRECCIÓN NACIONAL DE MERCADOS Y ESTADÍSTICA <a href="https://yvera.tur.ar/sinta"> - <b>www.yvera.tur.ar/sinta</a></b></span></div> 

---

## Ejemplo: IFAs No Residentes:  

### Punto de partida 

1. **16,69 M** de registros con información diaria de latitud y longitud a 5 decimales y país de origen del dispositivo.

--

2. Actividad de **592.684** de dispositivos únicos, durante 12 meses (año prepandemia).

--

#### Procesamiento (Ejemplo IFAs)


1. Registros iniciales: **16,69 M**

--

2. Exclusión de registros posteriores a marzo 2020 y/o con  coordenadas fuera de Argentina.

--

3. Redondeo de las coordenadas a tres decimales de precisión.

--

4. Deduplicación de registros con igual coordenada y fecha (año-mes-día)

--

#### Datos resultantes

- Registros seleccionados: **6,44 M** de **373.287** IFAs únicos.

---



### Herramienta de análisis: encontrando visitas a Rutas Naturales e imperdibles




---

```{r}

patagonia_andina <-  rutas_naturales %>% filter(name == "Ruta de la Patagonia Andina")

ifas_ext_patagonia_andina <- geo_ifas_ext_sample %>% 
  st_filter(patagonia_andina)



```


```{r}

ifas_ext_patagonia_andina %>% 
  leaflet() %>% 
  geoAr::addArgTiles() %>% 
  addPolygons(data = patagonia_andina, fillColor = ~rnpal(name), weight = 0) %>% 
  setView(lat = -41.137,lng =  -71.304, zoom = 5) %>% 
  addCircles(#color = ~ factpal(HomeCountry), fillOpacity = 1,
             popup = ~ lapply(glue::glue("Fecha: {Date}<br>IFA: {substr(IFA,1,7)}...<br>País: {pais}"),
                              htmltools::HTML))
  # addLegend(pal = factpal, values = unique(geo_ifas_ext_sample$HomeCountry)[1:10], opacity = 1)
```

---

```{r}

imperdibles <- read_file_srv('big_data/presentacion/imperdibles.gpkg')

imperdibles_patagonia_andina <- imperdibles %>% 
  filter(ruta_natural == "Patagonia Andina")


ifas_ext_patagonia_andina %>% 
  leaflet() %>% 
  geoAr::addArgTiles() %>% 
  addPolygons(data = imperdibles_patagonia_andina, fillColor = "#F7941E", color = "#F7941E", popup = ~ lapply(glue::glue("{nombre_ppal}"),
                              htmltools::HTML)) %>% 
  setView(lat = -41.137,lng =  -71.304, zoom = 5) %>% 
  addCircles(#color = ~ factpal(HomeCountry), fillOpacity = 1,
             popup = ~ lapply(glue::glue("Fecha: {Date}<br>IFA: {substr(IFA,1,7)}...<br>País: {pais}"),
                              htmltools::HTML))
  # addLegend(pal = factpal, values = unique(geo_ifas_ext_sample$HomeCountry)[1:10], opacity = 1) 

```


